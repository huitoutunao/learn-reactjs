<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>useState心智模型</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: sans-serif; margin: 20px; padding: 0; }
    button { display: block; margin-bottom: 10px; }
  </style>
</head>
<body>
  <button id="nextButton">
    Next
  </button>
  <h3 id="header"></h3>
  <button id="moreButton"></button>
  <p id="description"></p>
  <img id="image">

  <script>
    let componentHooks = []
    let currentHookIndex = 0

    function useState(initialState) {
      let pair = componentHooks[currentHookIndex]
      if (pair) {
        // 这不是第一次渲染
        // 所以 state pair 已经存在
        // 将其返回并为下一次 hook 的调用做准备
        currentHookIndex++
        return pair
      }

      // 这是我们第一次进行渲染
      // 所以新建一个 state pair 然后存储它
      pair = [initialState, setState]

      function setState(nextState) {
        // 当用户发起 state 的变更，
        // 把新的值放入 pair 中
        pair[0] = nextState
        updateDOM()
      }

      // 存储这个 pair 用于将来的渲染
      // 并且为下一次 hook 的调用做准备
      componentHooks[currentHookIndex] = pair
      currentHookIndex++
      return pair
    }

    function Gallery() {}

    function updateDOM() {
      // 在渲染组件之前
      // 重置当前 Hook 的下标
      currentHookIndex = 0
      let output = Gallery()
    }

    updateDOM()
  </script>
</body>
</html>
